<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>微信名片</title>

	<link rel="stylesheet" href="http://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css">
	<link rel="stylesheet" href="/stylesheets/front.css">
	<link rel="stylesheet" type="text/css" href="/wangeditor/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/wangeditor/css/wangEditor.min.css">
    <style type="text/css">
        .editor-text {
            height: 500px;
            /*max-height: 500px;*/
        }
        .wangEditor-container {
            width: 100%;
            margin: 0 auto;
            position: relative;
        }
    </style>
</head>
<body onLoad="goPage(1,10);">
	<div class="navbar navbar-default navbar-static-top" role="navigation">
		<div class="container-fluid">
			<div class="navbar-header">
				<a class="navbar-brand" href="/">微信名片</a>
			</div>
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="/edit">
						你好, <%= currentUser.username %>
					</a>
				</li>
				<li><a href="/logout">退出</a></li>
			</ul>
		</div>
	</div>
	<div class="container">
 	<table id="idData" width="70%">
 		<% for(var i=0; i < cards.length; i++) {%>
   		<div style="margin: 10px">
   		<form action="/update" method="get">
   		<input type="hidden" name="name" value="<%= currentUser.username %>">
   		<input type="hidden" name="card" value="<%= cards[i] %>">
   		<span><%= cards[i] %></span>
   		<input type="submit" value="编辑"></form></div>
		<% } %>
    </table> 
    </div>
    <div class="container-fluid">
    <table width="60%" align="right">
        <tr><td><div id="barcon" name="barcon"></div></td></tr>
    </table>
	</div>

	<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
	<script src="http://apps.bdimg.com/libs/angular.js/1.4.6/angular.min.js"></script>
	<script src="http://apps.bdimg.com/libs/angular-route/1.3.13/angular-route.min.js"></script>
	
 	<!-- qrcode package -->
	<script src="/javascripts/qrcode.js"></script>
	<script src="/javascripts/qrcode_UTF8.js"></script>
	<script src="/javascripts/angular-qrcode.js"></script>
	<!-- qrcode package -->

	<script src="/javascripts/app.js"></script>
	<script src="/javascripts/main.js"></script>

	<!-- wangeditor with qiniu sdk -->
    <script type="text/javascript" src="/wangeditor/js/wangEditor.min.js"></script>
    <script type="text/javascript" src="/wangeditor/js/plupload/plupload.full.min.js"></script>
    <script type="text/javascript" src="/wangeditor/js/plupload/i18n/zh_CN.js"></script>
    <script type="text/javascript" src="/wangeditor/js/qiniu.js"></script>
    <!-- wangeditor with qiniu sdk -->  


<script type="text/javascript">
    /**
 * 分页函数
 * pno--页数
 * psize--每页显示记录数
 * 分页部分是从真实数据行开始，因而存在加减某个常数，以确定真正的记录数
 * 纯js分页实质是数据行全部加载，通过是否显示属性完成分页功能
 **/
	function goPage(pno,psize){
	    var itable = document.getElementById("idData");
	    var num = itable.rows.length;//表格所有行数(所有记录数)
	    var totalPage = 0;//总页数
	    var pageSize = psize;//每页显示行数
	    //总共分几页 
	    if(num/pageSize > parseInt(num/pageSize)){   
	            totalPage=parseInt(num/pageSize)+1;   
	       }else{   
	           totalPage=parseInt(num/pageSize);   
	       }   
	    var currentPage = pno;//当前页数
	    var startRow = (currentPage - 1) * pageSize+1;//开始显示的行  31 
	       var endRow = currentPage * pageSize;//结束显示的行   40
	       endRow = (endRow > num)? num : endRow;    40
	       console.log(endRow);
	       //遍历显示数据实现分页
	    for(var i=1;i<(num+1);i++){    
	        var irow = itable.rows[i-1];
	        if(i>=startRow && i<=endRow){
	            irow.style.display = "block";    
	        }else{
	            irow.style.display = "none";
	        }
	    }
	    var pageEnd = document.getElementById("pageEnd");
	    var tempStr = "共"+num+"条记录 分"+totalPage+"页 当前第"+currentPage+"页";
	    if(currentPage>1){
	        tempStr += "<a href=\"#\" onClick=\"goPage("+(1)+","+psize+")\">首页</a>";
	        tempStr += "<a href=\"#\" onClick=\"goPage("+(currentPage-1)+","+psize+")\"><上一页</a>"
	    }else{
	        tempStr += "首页";
	        tempStr += "<上一页";    
	    }

	    if(currentPage<totalPage){
	        tempStr += "<a href=\"#\" onClick=\"goPage("+(currentPage+1)+","+psize+")\">下一页></a>";
	        tempStr += "<a href=\"#\" onClick=\"goPage("+(totalPage)+","+psize+")\">尾页</a>";
	    }else{
	        tempStr += "下一页>";
	        tempStr += "尾页";    
	    }

	    document.getElementById("barcon").innerHTML = tempStr;
	    
	}
</script>	

</body>
</html>